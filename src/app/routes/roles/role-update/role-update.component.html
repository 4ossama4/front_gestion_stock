<page-header [title]="'Modifier le roles'"></page-header>
<form [formGroup]="roleForm">
  <nz-card nzTitle="Information du Role" [nzBodyStyle]="{ padding: '18px' }" class="mt-5" style="border-radius: 5px" [nzBordered]="true">
    <div class="row">
      <div class="col-md-6 col-6">
        <div nz-row [nzGutter]="24">
          <div nz-col [nzSpan]="24">
            <nz-form-item>
              <nz-form-label [nzSpan]="8" nzFor="name">Nom de Role </nz-form-label>
              <nz-form-control nzErrorTip="Ce champs est obligatoire" [nzSpan]="16">
                <input nz-input formControlName="name" />
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
      </div>
      <div class="col-md-6 col-6">
        <div nz-row [nzGutter]="24">
          <div nz-col [nzSpan]="24">
            <nz-form-item>
              <nz-form-label [nzSpan]="8" nzFor="label">Description</nz-form-label>
              <nz-form-control nzErrorTip="Ce champs est obligatoire" [nzSpan]="16">
                <input nz-input formControlName="label" />
              </nz-form-control>
            </nz-form-item>
          </div>
        </div>
      </div>
    </div>
  </nz-card>

  <nz-card
    nzTitle="Les permissions du role"
    [nzBodyStyle]="{ padding: '18px' }"
    class="mt-5"
    style="border-radius: 5px"
    [nzBordered]="true"
  >
    <div formArrayName="categories" class="row m-0">
      <ng-container *ngFor="let categorie of roleForm.get('categories').controls; let i = index">
        <div [formGroupName]="i" class="col-md-4 mb-2">
          <ul class="p-2 div-category" style="list-style: none; height: 100%">
            <li class="pb-1" style="border-bottom: 1px solid #e8e8e8">
              <label
                style="font-weight: 600; color: #150485"
                formControlName="check"
                (ngModelChange)="checkAllPermissionCategory($event, i, true)"
                nz-checkbox
              >
                {{ categorie?.value?.category?.label }}</label
              >
              <!-- {{ categorie?.value?.category?.label }} -->
            </li>
            <ul class="pt-2 pl-4" style="list-style: none" formArrayName="liste_permissions">
              <ng-container
                *ngFor="let permission of roleForm.get('categories').controls[i].get('liste_permissions').controls; let j = index"
              >
                <li [formGroupName]="j">
                  <label nz-checkbox (ngModelChange)="checkPermission(i, j)" formControlName="check"> {{ permission.value.label }}</label>

                  <!-- <input nz-input formControlName="label" /> -->
                </li>
              </ng-container>
            </ul>
          </ul>
        </div>
      </ng-container>
    </div>
  </nz-card>

  <nz-card
    [nzBodyStyle]="{ 'padding-left': '18px', 'padding-right': '18px', 'padding-top': '6px', 'padding-bottom': '6px' }"
    class="mt-5"
    style="border-radius: 5px"
    [nzBordered]="true"
  >
    <div class="row">
      <div class="col-md-12">
        <button style="float: right" (click)="saveRole()" class="d-flex align-items-center ml-2" nz-button nzType="primary">
          Enregistrer <i class="fal fa-save ml-3"></i>
        </button>
        <button style="float: right" (click)="gotoListe()" class="d-flex align-items-center" nz-button nzType="default">
          <i class="fal fa-reply mr-3"></i> Annuler
        </button>
      </div>
    </div>
  </nz-card>
</form>
