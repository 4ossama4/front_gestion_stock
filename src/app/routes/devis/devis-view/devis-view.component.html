<page-header [title]="'Détails de devis  : ' + venteData?.reference_devis"></page-header>
<nz-card
  [nzBodyStyle]="{ 'padding-top': '.5rem', 'padding-bottom': '.5rem', 'padding-left': '18px', 'padding-right': '18px' }"
  class="mt-5"
  style="border-radius: 5px"
  [nzBordered]="true"
>
  <div class="row">
    <div class="col-md-6">
      <button (click)="goToList()" nz-button nzType="default"><i class="fal fa-chevron-left pr-2"></i>Liste des devis</button>
    </div>
    <div class="col-md-6 text-right">
      <button *ngIf="ROLE_UPDATE" (click)="gotoEdit()" nz-button nzType="primary">Modifier <i class="fal fa-pen pl-2"></i></button>
    </div>
  </div>
</nz-card>

<nz-card [nzBodyStyle]="{ padding: '18px' }" class="mt-3" style="border-radius: 5px" [nzBordered]="true">
  <div class="row">
    <div class="col-md-6">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="24">
          <nz-form-item class="mb-0">
            <nz-form-label [nzSpan]="8" nzFor="date">Date </nz-form-label>
            <nz-form-control [nzSpan]="16">
              {{ venteData?.date_devis }}
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="24">
          <nz-form-item class="mb-0">
            <nz-form-label [nzSpan]="8" nzFor="name">Client</nz-form-label>
            <nz-form-control [nzSpan]="16">
              {{ venteData?.client?.name }}
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <div nz-row [nzGutter]="24">
        <div nz-col [nzSpan]="24">
          <nz-form-item>
            <nz-form-label [nzSpan]="8" nzFor="payment_mode_id">Date Expiration </nz-form-label>
            <nz-form-control [nzSpan]="16">
              {{ venteData?.date_expire }}
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </div>
  </div>

  <div class="row div-articles m-0 pt-2 pb-2">
    <div class="col-md-6">
      <label style="font-size: inherit" class="mb-0 title-article"> Liste des Articles ({{ venteData?.lignes_devis.length }}) :</label>
    </div>
    <div class="col-md-12 pt-2">
      <div class="row">
        <div class="col-md-2">Article :</div>
        <div class="col-md-2">Désignation :</div>
        <div class="col-md-2">Quantite :</div>
        <div class="col-md-2">Prix-U :</div>
        <div class="col-md-2">Remise :</div>
        <div class="col-md-2">Total :</div>
        <div class="col-md-12">
          <hr class="mt-2" />
        </div>
      </div>

      <ng-container *ngFor="let ligneVente of venteData?.lignes_devis; let i = index">
        <div class="row pt-2 m-0 mb-2 pb-2 d-flex align-items-center div-ligne-achat">
          <div class="col-md-2 col-2">
            {{ ligneVente.article?.reference }}
          </div>
          <div class="col-md-2 col-2">
            {{ ligneVente.article?.designation }}
          </div>
          <div class="col-md-2 col-2">
            {{ ligneVente.quantite }}
          </div>
          <div class="col-md-2 col-2">{{ ligneVente.prix_devis | priceFormat }} DH</div>
          <div class="col-md-2 col-2">
            {{ ligneVente.remise }}
          </div>
          <div class="col-md-2 col-2">{{ ligneVente.total_with_remise }} DH</div>
        </div>
      </ng-container>
    </div>
  </div>
  <div class="row div-articles m-0 mt-5 pt-3 pb-3 pr-3">
    <div class="col-md-4">
      <label class="mb-1" style="font-weight: 600"> Les Informations supplémentaire : </label>
      <hr class="mt-2" />
      <div>
        {{ venteData?.remarques }}
      </div>
    </div>
    <div class="col-md-4"></div>
    <div class="col-md-4 pt-3 pb-3" style="background: white; border-radius: 5px">
      <div>
        <span>Total En DH : </span>
        <br />
        <span style="font-weight: 600; font-size: 22px; color: #242582">{{ venteData?.prix_devis_ttc | priceFormat }} DH </span>
      </div>
      <div *ngIf="venteData?.prix_devis_ttc > venteData?.prix_devis_ttc_with_remise">
        <span>Remise : </span>
        <br />
        <span style="font-weight: 600; font-size: 22px"
          >{{ venteData?.prix_devis_ttc - venteData?.prix_devis_ttc_with_remise | priceFormat }}
          DH
        </span>
      </div>
      <div *ngIf="venteData?.prix_devis_ttc > venteData?.prix_devis_ttc_with_remise">
        <span>Total avec remise : </span>
        <br />
        <span style="font-weight: 600; font-size: 22px; color: #e01372">{{ venteData?.prix_devis_ttc_with_remise | priceFormat }} DH </span>
      </div>

      <!-- <div>
        <hr class="mt-2 mb-2" />
      </div> -->
    </div>
  </div>
</nz-card>
